<!doctype html>
<html>

<head>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.0/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
  
<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script>
    var MonthlyPayments = Backbone.Collection.extend({  total:function() {
       var total = 0;
       this.map(function(obj) {
           total = obj.get("amount") + total;
       })
       return total;
      }})
  var RegularMonthlyPayment = Backbone.Model.extend({
    
  })  
  
  var rent = new RegularMonthlyPayment({
      type: "rent", 
      amount: 221.74, 
      day: 1,
      startDate: "",
      endDate: ""
  })
  
  var councilTax = new RegularMonthlyPayment({
      type: "Council Tax",
      amount: 94,
      day: 26,
      startDate: "",
      endDate: ""
  })
  
  var electricity = new RegularMonthlyPayment({
      type:"Electricity",
      amount: 28.50,
      day: 26,
      startDate: "",
      endDate:""
  })
  
var water = new RegularMonthlyPayment({
    type:"Water",
    amount: 43.6, 
    day: 26, 
    startDate: "", 
    endDate: ""
}) 

var landline = new RegularMonthlyPayment({
    type: "Landline",
    amount: 21.01,
    day: 26
})
var mobile = new RegularMonthlyPayment({
    amount: 14
})

var hotWater = new RegularMonthlyPayment({
    amount: 22
})

    var monthly_payments = new MonthlyPayments([rent, councilTax, electricity, mobile, hotWater, water, landline])
    console.log(monthly_payments.total())
var CreditCardPayment = Backbone.Collection.extend({})

var halifax_cc= new CreditCardPayment({
    interest_rate: 0,
    balance: 2813.67, 
    payment_date: 29,
    minimumPayment:1/100,
    monthOfBalance:4
})

var rent = {5: 221.74, 6: 291.74, 7: 291.74, 8: 243.03, 9: 221.74, 10: 221.74, 11: 221.74}


        //0 = Sunday, 1 = Monday, 2 = Tuesday, 3 = Wed, 4 = Thurs, 5 = Fri, 6 = Sat

        var currentDate = new Date();
        var month = currentDate.getMonth(); //0 = January, 1 = February
        var monthsInYear = 11
        var i = 0;
        var previousPayDate;
        for (i = month; i <= 11; i++) { //loop through remaining months left in year
// Monday 25th June
            var payday = payDates2018[i];
            var paydate = new Date(2018, i, payday)
            paydate = getRealPayDate(paydate);
           
           if(i == currentDate.getMonth()) {
               var startDate =  currentDate;
           } else { 
            var startDate= new Date(previousPayDate)
            startDate.setDate(startDate.getDate()+1)
           }
           
        var result = numberOfDays(startDate, paydate);
        var sundays = numberOfSundays(startDate,paydate);
        
        var sundayPay = (sundayHours * sundays) * (9.13/2);
        var totalPay = sundayPay + contractualPay;
        
        if(halifax.monthOfBalance == currentDate.getMonth()) {
            halifax.monthOfBalance = currentDate.getMonth() +1;
            
           var halifaxMinimumPayment = (halifax.minimumPayment * halifax.balance)
           
            halifax.balance = halifax.balance - halifaxMinimumPayment
        } else { 
           var halifaxMinimumPayment = (halifax.minimumPayment * halifax.balance)
            halifax.balance = halifax.balance - halifaxMinimumPayment
        }
        
        
        console.log("TOTALPAY: " + totalPay)
        console.log(i)
        
        console.log((result * 330) / 100 + "\n\n")
        console.log("\nTOTAL OUTGOINGS:" + (monthlyOutgoings + rent[i] + (result * 330)/100))
        console.log("\nHALIFAX:" + halifaxMinimumPayment)
           previousPayDate = paydate;
        }



        function numberOfDays(fromDate, toDate) {
            var fromDate = new Date(fromDate);
            var toDate = new Date(toDate)
            var weekendDayCount = 0;

            while (fromDate < toDate) {
                fromDate.setDate(fromDate.getDate() + 1);
                if (fromDate.getDay() === 0 || fromDate.getDay() === 6 || fromDate.getDay() === 1) {
                    ++weekendDayCount;
                }
            }

            return weekendDayCount;
        }
        
        
        
        function numberOfSundays(fromDate, toDate) {
            var fromDate = new Date(fromDate);
            var toDate = new Date(toDate);
            var sundayCount = 0;
            console.log(fromDate,toDate)

            while (fromDate < toDate) {
                fromDate.setDate(fromDate.getDate() + 1);
                
                if (fromDate.getDay() === 0) {
                    
                    ++sundayCount;
                }
            }
            return sundayCount;
        }

    </script>
</head>

</html>